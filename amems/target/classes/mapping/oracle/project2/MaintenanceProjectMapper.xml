<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.eray.thjw.project2.dao.MaintenanceProjectMapper" >
  <resultMap id="BaseResultMap" type="com.eray.thjw.project2.po.MaintenanceProject" >
    <id column="ID" property="id" jdbcType="VARCHAR" />
    <result column="DPRTCODE" property="dprtcode" jdbcType="VARCHAR" />
    <result column="JX" property="jx" jdbcType="VARCHAR" />
    <result column="WXFABH" property="wxfabh" jdbcType="VARCHAR" />
    <result column="WXXMDLID" property="wxxmdlid" jdbcType="VARCHAR" />
    <result column="WXXMLX" property="wxxmlx" jdbcType="DECIMAL" />
    <result column="ZJH" property="zjh" jdbcType="VARCHAR" />
    <result column="RWH" property="rwh" jdbcType="VARCHAR" />
    <result column="BB" property="bb" jdbcType="DECIMAL" />
    <result column="CKH" property="ckh" jdbcType="VARCHAR" />
    <result column="RWMS" property="rwms" jdbcType="VARCHAR" />
    <result column="SYX" property="syx" jdbcType="VARCHAR" />
    <result column="CKWJ" property="ckwj" jdbcType="VARCHAR" />
    <result column="GZLX" property="gzlx" jdbcType="VARCHAR" />
    <result column="XMLX" property="xmlx" jdbcType="VARCHAR" />
    <result column="IS_BJ" property="isBj" jdbcType="DECIMAL" />
    <result column="ALI" property="ali" jdbcType="DECIMAL" />
    <result column="JHGS_RS" property="jhgsRs" jdbcType="DECIMAL" />
    <result column="JHGS_XSS" property="jhgsXss" jdbcType="DECIMAL" />
    <result column="GKBH" property="gkbh" jdbcType="VARCHAR" />
    <result column="JSGS" property="jsgs" jdbcType="DECIMAL" />
    <result column="IS_HDWZ" property="isHdwz" jdbcType="DECIMAL" />
    <result column="BZ" property="bz" jdbcType="VARCHAR" />
    <result column="ZT" property="zt" jdbcType="DECIMAL" />
    <result column="YXBS" property="yxbs" jdbcType="DECIMAL" />
    <result column="F_BBID" property="fBbid" jdbcType="VARCHAR" />
    <result column="B_BBID" property="bBbid" jdbcType="VARCHAR" />
    <result column="ZDBMID" property="zdbmid" jdbcType="VARCHAR" />
    <result column="ZDRID" property="zdrid" jdbcType="VARCHAR" />
    <result column="ZDSJ" property="zdsj" jdbcType="TIMESTAMP" />
    <result column="EOBH" property="eobh" jdbcType="VARCHAR" />
    <result column="CMPH" property="cmph" jdbcType="VARCHAR" />
    <result column="WZ" property="wz" jdbcType="DECIMAL" />
    <result column="JGMS" property="jgms" jdbcType="VARCHAR" />
    <result column="ATTACHCOUNT" property="paramsMap.attachCount" jdbcType="VARCHAR" /><!-- 附件数量 -->
    <result column="QYSTR" property="paramsMap.qyStr" jdbcType="VARCHAR" /><!-- 区域 -->
    <result column="JJSTR" property="paramsMap.jjStr" jdbcType="VARCHAR" /><!-- 接近 -->
    <result column="FJZWSTR" property="paramsMap.fjzwStr" jdbcType="VARCHAR" /><!-- 飞机站位 -->
    <result column="OPERATOR" property="paramsMap.operator" jdbcType="VARCHAR" /><!-- 新增、改版、删除 -->
    
  </resultMap>
  
  <resultMap type="com.eray.thjw.project2.po.MaintenanceProject" id="MaintenanceProjectJoinMap" extends="BaseResultMap">  
  		<association property="zdr" javaType="com.eray.thjw.po.User">  
	        <id column="ZDRID" property="id"/>  
	        <result column="ZDRUSERNAME" property="username"/>  
	        <result column="ZDRREALNAME" property="realname"/>  
	    </association>  
        <association property="fixChapter" javaType="com.eray.thjw.po.FixChapter">
	    	<id column="D1ZJH" property="zjh"/>
	     	<result column="D1ZWMS" property="zwms"/>
	        <result column="D1YWMS" property="ywms"/>
	    </association>
	    <association property="maintenanceClass" javaType="com.eray.thjw.project2.po.MaintenanceClass">
	    	<id column="B3ID" property="id"/>
		    <result column="B3JX" property="jx" jdbcType="VARCHAR" />
		    <result column="B3DLBH" property="dlbh" jdbcType="VARCHAR" />
		    <result column="B3DLZWMS" property="dlzwms" jdbcType="VARCHAR" />
		    <result column="B3DLYWMS" property="dlywms" jdbcType="VARCHAR" />
	    </association>
	    <association property="eo" javaType="com.eray.thjw.project2.po.EngineeringOrder">
	    	<id column="EID" property="id"/>
		    <result column="EEOBH" property="eobh" jdbcType="VARCHAR" />
		    <result column="EBB" property="bb" jdbcType="DECIMAL" />
		    <result column="EEOZT" property="eozt" jdbcType="VARCHAR" />
	    </association>
	    <association property="scheme" javaType="com.eray.thjw.project2.po.MaintenanceScheme">
	    	<id column="WID" property="id"/>
		    <result column="WDPRTCODE" property="dprtcode" jdbcType="VARCHAR" />
		    <result column="WJX" property="jx" jdbcType="VARCHAR" />
		    <result column="WWXFABH" property="wxfabh" jdbcType="VARCHAR" />
		    <result column="WBB" property="bb" jdbcType="DECIMAL" />
		    <result column="WZWMS" property="zwms" jdbcType="VARCHAR" />
		    <result column="WZXBS" property="zxbs" jdbcType="DECIMAL" />
		    <result column="WZT" property="zt" jdbcType="DECIMAL" />
		    <result column="WGBYJ" property="gbyj" jdbcType="VARCHAR" />
		    <result column="WSJSXRQ" property="sjSxrq" jdbcType="TIMESTAMP" />
		    <collection property="technicalList" ofType="com.eray.thjw.project2.po.Technical">  
	            <id column="TECID" property="id" jdbcType="VARCHAR" />
			    <result column="TECPGDZT" property="pgdzt" jdbcType="VARCHAR" />
			    <result column="TECPGDH" property="pgdh" jdbcType="VARCHAR" />
			    <result column="TECBB" property="bb" jdbcType="DECIMAL" />
	        </collection>  
	    </association>
	    <association property="newestScheme" javaType="com.eray.thjw.project2.po.MaintenanceScheme">
	    	<id column="NEWID" property="id"/>
		    <result column="NEWDPRTCODE" property="dprtcode" jdbcType="VARCHAR" />
		    <result column="NEWJX" property="jx" jdbcType="VARCHAR" />
		    <result column="NEWWXFABH" property="wxfabh" jdbcType="VARCHAR" />
		    <result column="NEWBB" property="bb" jdbcType="DECIMAL" />
		    <result column="NEWZWMS" property="zwms" jdbcType="VARCHAR" />
		    <result column="NEWZXBS" property="zxbs" jdbcType="DECIMAL" />
		    <result column="NEWZT" property="zt" jdbcType="DECIMAL" />
	    </association>
	    <collection property="projectMaterialList" ofType="com.eray.thjw.project2.po.ProjectMaterial">  
		    <id column="B2ID" property="id" jdbcType="VARCHAR" />
		    <result column="B2BJH" property="bjh" jdbcType="VARCHAR" />
		    <result column="B2CJ" property="cj" jdbcType="VARCHAR" />
        </collection>
         <!-- 区域、飞机站位、接近 -->
	    <collection property="coverPlateList" ofType="com.eray.thjw.project2.po.CoverPlate">  
		    <id column="CP_ID" property="id" jdbcType="VARCHAR" />
		    <result column="CP_LX" property="lx" jdbcType="DECIMAL" />
		    <result column="CP_GBID" property="gbid" jdbcType="VARCHAR" />
		    <result column="CP_GBH" property="gbh" jdbcType="VARCHAR" />
		    <result column="CP_XC" property="xc" jdbcType="DECIMAL" />
		    <association property="coverPlateInformation" javaType="com.eray.thjw.basic.po.CoverPlateInformation">
		    	<id column="CPI_ID" property="id"/>
		     	<result column="CPI_GBBH" property="gbbh"/>
		        <result column="CPI_GBMC" property="gbmc"/>
		    </association>
        </collection>
        <collection property="projectMonitors" ofType="com.eray.thjw.project2.po.ProjectMonitor">  
		    <id column="B4ID" property="id" jdbcType="VARCHAR" />
		    <result column="B4JKLBH" property="jklbh" jdbcType="VARCHAR" />
		    <result column="B4JKFLBH" property="jkflbh" jdbcType="VARCHAR" />
		    <result column="B4SCZ" property="scz" jdbcType="VARCHAR" />
		    <result column="B4DW_SCZ" property="dwScz" jdbcType="DECIMAL" />
		    <result column="B4ZQZ" property="zqz" jdbcType="VARCHAR" />
		    <result column="B4DW_ZQZ" property="dwZqz" jdbcType="DECIMAL" />
		    <result column="B4YDZ_Q" property="ydzQ" jdbcType="VARCHAR" />
		    <result column="B4YDZ_QDW" property="ydzQdw" jdbcType="DECIMAL" />
		    <result column="B4YDZ_H" property="ydzH" jdbcType="VARCHAR" />
		    <result column="B4YDZ_HDW" property="ydzHdw" jdbcType="DECIMAL" />
		    <result column="B4BJH" property="bjh" jdbcType="VARCHAR" />
		    <result column="B4CJ" property="cj" jdbcType="VARCHAR" />
		    <association property="monitorOptionClass" javaType="com.eray.thjw.po.MonitorOptionClass">
		        <id column="B4D1JKFLBH" property="jkflbh" jdbcType="VARCHAR" />
			    <result column="B4D1MS" property="ms" jdbcType="VARCHAR" />
			    <result column="B4D1PXH" property="pxh" jdbcType="DECIMAL" />
		    </association>
		    <association property="monitorOptionItem" javaType="com.eray.thjw.po.MonitorOptionItem">
		        <id column="B4D2JKLBH" property="jklbh" jdbcType="VARCHAR" />
			    <result column="B4D2MS" property="ms" jdbcType="VARCHAR" />
			    <result column="B4D2PXH" property="pxh" jdbcType="DECIMAL" />
			    <result column="B4D2JKFLBH" property="jkflbh" jdbcType="VARCHAR" />
		    </association>
        </collection>
        <collection property="projectModelList" ofType="com.eray.thjw.project2.po.ProjectModel">  
		    <id column="B5ID" property="id" jdbcType="VARCHAR" />
		    <result column="B5FJZCH" property="fjzch" jdbcType="VARCHAR" />
        </collection>
  </resultMap>
   
  <sql id="Base_Column_List" >
    ID, DPRTCODE, JX, WXFABH, WXXMDLID, WXXMLX, ZJH, RWH, BB, CKH, RWMS, SYX, CKWJ, GZLX, 
    XMLX, IS_BJ, ALI, JHGS_RS, JHGS_XSS, GKBH, JSGS, IS_HDWZ, BZ, ZT, YXBS, F_BBID, 
    B_BBID, ZDBMID, ZDRID, ZDSJ, EOBH, CMPH, WZ, JGMS
  </sql>
  
  <sql id="Maintenance_Project_Column_List" >
    B.ID, B.DPRTCODE, B.JX, B.WXFABH, B.WXXMDLID, B.WXXMLX, B.ZJH, B.RWH, B.BB, B.CKH, B.RWMS, B.SYX, B.CKWJ, B.GZLX, B.XMLX, B.IS_BJ, 
    B.ALI, B.JHGS_RS, B.JHGS_XSS, B.GKBH, B.JSGS, B.IS_HDWZ, B.BZ, B.ZT, B.YXBS, B.F_BBID, B.B_BBID, B.ZDBMID, B.ZDRID, 
    B.ZDSJ, B.EOBH, B.CMPH, B.WZ, B.JGMS
  </sql>
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from B_G2_012
    where ID = #{id,jdbcType=VARCHAR}
  </select>
  
  <!-- 检查维修项目是否存在 -->
  <select id="checkExist" resultType="int" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    SELECT COUNT(1) FROM B_G2_012
	    WHERE JX = #{jx,jdbcType=VARCHAR} 
	      AND DPRTCODE = #{dprtcode,jdbcType=VARCHAR} 
	      AND RWH = #{rwh,jdbcType=VARCHAR}
	      <if test="id != null and id != ''">
	          AND ID != #{id,jdbcType=VARCHAR}
	      </if>
  </select>
  
  <!-- 检查维修项目是否存在（带版本） -->
  <select id="checkExistWithVersion" resultType="int" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    SELECT COUNT(1) FROM B_G2_012
	    WHERE JX = #{jx,jdbcType=VARCHAR} 
	      AND DPRTCODE = #{dprtcode,jdbcType=VARCHAR} 
	      AND RWH = #{rwh,jdbcType=VARCHAR}
	      AND BB = #{bb,jdbcType=DECIMAL}
	      <if test="id != null and id != ''">
	          AND ID != #{id,jdbcType=VARCHAR}
	      </if>
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    delete from B_G2_012
    where ID = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    insert into B_G2_012 (ID, DPRTCODE, JX, 
      WXFABH, WXXMDLID, WXXMLX, 
      ZJH, RWH, BB, CKH, 
      RWMS, SYX, CKWJ, GZLX, 
      XMLX, IS_BJ, ALI, 
      JHGS_RS, JHGS_XSS, GKBH, EOBH ,
      JSGS, IS_HDWZ, BZ, ZT, 
      YXBS, F_BBID, B_BBID, 
      ZDBMID, ZDRID, ZDSJ,
      CMPH, WZ, JGMS
      )
    values (#{id,jdbcType=VARCHAR}, #{dprtcode,jdbcType=VARCHAR}, #{jx,jdbcType=VARCHAR}, 
      #{wxfabh,jdbcType=VARCHAR}, #{wxxmdlid,jdbcType=VARCHAR}, #{wxxmlx,jdbcType=DECIMAL}, 
      #{zjh,jdbcType=VARCHAR}, #{rwh,jdbcType=VARCHAR}, #{bb,jdbcType=DECIMAL}, #{ckh,jdbcType=VARCHAR}, 
      #{rwms,jdbcType=VARCHAR}, #{syx,jdbcType=VARCHAR}, #{ckwj,jdbcType=VARCHAR}, #{gzlx,jdbcType=VARCHAR}, 
      #{xmlx,jdbcType=VARCHAR}, #{isBj,jdbcType=DECIMAL}, #{ali,jdbcType=DECIMAL}, 
      #{jhgsRs,jdbcType=DECIMAL}, #{jhgsXss,jdbcType=DECIMAL}, #{gkbh,jdbcType=VARCHAR}, #{eobh,jdbcType=VARCHAR},
      #{jsgs,jdbcType=DECIMAL}, #{isHdwz,jdbcType=DECIMAL}, #{bz,jdbcType=VARCHAR}, #{zt,jdbcType=DECIMAL}, 
      #{yxbs,jdbcType=DECIMAL}, #{fBbid,jdbcType=VARCHAR}, #{bBbid,jdbcType=VARCHAR}, 
      #{zdbmid,jdbcType=VARCHAR}, #{zdrid,jdbcType=VARCHAR}, #{zdsj,jdbcType=TIMESTAMP},
      #{cmph,jdbcType=VARCHAR}, #{wz,jdbcType=DECIMAL}, #{jgms,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    insert into B_G2_012
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        ID,
      </if>
      <if test="dprtcode != null" >
        DPRTCODE,
      </if>
      <if test="jx != null" >
        JX,
      </if>
      <if test="wxfabh != null" >
        WXFABH,
      </if>
      <if test="wxxmdlid != null" >
        WXXMDLID,
      </if>
      <if test="wxxmlx != null" >
        WXXMLX,
      </if>
      <if test="zjh != null" >
        ZJH,
      </if>
      <if test="rwh != null" >
        RWH,
      </if>
      <if test="bb != null" >
        BB,
      </if>
      <if test="ckh != null" >
        CKH,
      </if>
      <if test="rwms != null" >
        RWMS,
      </if>
      <if test="syx != null" >
        SYX,
      </if>
      <if test="ckwj != null" >
        CKWJ,
      </if>
      <if test="gzlx != null" >
        GZLX,
      </if>
      <if test="xmlx != null" >
        XMLX,
      </if>
      <if test="isBj != null" >
        IS_BJ,
      </if>
      <if test="ali != null" >
        ALI,
      </if>
      <if test="jhgsRs != null" >
        JHGS_RS,
      </if>
      <if test="jhgsXss != null" >
        JHGS_XSS,
      </if>
      <if test="gkbh != null" >
        GKBH,
      </if>
      <if test="eobh != null" >
        EOBH,
      </if>
      <if test="jsgs != null" >
        JSGS,
      </if>
      <if test="isHdwz != null" >
        IS_HDWZ,
      </if>
      <if test="bz != null" >
        BZ,
      </if>
      <if test="zt != null" >
        ZT,
      </if>
      <if test="yxbs != null" >
        YXBS,
      </if>
      <if test="fBbid != null" >
        F_BBID,
      </if>
      <if test="bBbid != null" >
        B_BBID,
      </if>
      <if test="zdbmid != null" >
        ZDBMID,
      </if>
      <if test="zdrid != null" >
        ZDRID,
      </if>
      <if test="zdsj != null" >
        ZDSJ,
      </if>
      <if test="cmph != null" >
        CMPH,
      </if>
      <if test="wz != null" >
        WZ,
      </if>
      <if test="jgms != null" >
        JGMS,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="dprtcode != null" >
        #{dprtcode,jdbcType=VARCHAR},
      </if>
      <if test="jx != null" >
        #{jx,jdbcType=VARCHAR},
      </if>
      <if test="wxfabh != null" >
        #{wxfabh,jdbcType=VARCHAR},
      </if>
      <if test="wxxmdlid != null" >
        #{wxxmdlid,jdbcType=VARCHAR},
      </if>
      <if test="wxxmlx != null" >
        #{wxxmlx,jdbcType=DECIMAL},
      </if>
      <if test="zjh != null" >
        #{zjh,jdbcType=VARCHAR},
      </if>
      <if test="rwh != null" >
        #{rwh,jdbcType=VARCHAR},
      </if>
      <if test="bb != null" >
        #{bb,jdbcType=DECIMAL},
      </if>
      <if test="ckh != null" >
        #{ckh,jdbcType=VARCHAR},
      </if>
      <if test="rwms != null" >
        #{rwms,jdbcType=VARCHAR},
      </if>
      <if test="syx != null" >
        #{syx,jdbcType=VARCHAR},
      </if>
      <if test="ckwj != null" >
        #{ckwj,jdbcType=VARCHAR},
      </if>
      <if test="gzlx != null" >
        #{gzlx,jdbcType=VARCHAR},
      </if>
      <if test="xmlx != null" >
        #{xmlx,jdbcType=VARCHAR},
      </if>
      <if test="isBj != null" >
        #{isBj,jdbcType=DECIMAL},
      </if>
      <if test="ali != null" >
        #{ali,jdbcType=DECIMAL},
      </if>
      <if test="jhgsRs != null" >
        #{jhgsRs,jdbcType=DECIMAL},
      </if>
      <if test="jhgsXss != null" >
        #{jhgsXss,jdbcType=DECIMAL},
      </if>
      <if test="gkbh != null" >
        #{gkbh,jdbcType=VARCHAR},
      </if>
      <if test="eobh != null" >
        #{eobh,jdbcType=VARCHAR},
      </if>
      <if test="jsgs != null" >
        #{jsgs,jdbcType=DECIMAL},
      </if>
      <if test="isHdwz != null" >
        #{isHdwz,jdbcType=DECIMAL},
      </if>
      <if test="bz != null" >
        #{bz,jdbcType=VARCHAR},
      </if>
      <if test="zt != null" >
        #{zt,jdbcType=DECIMAL},
      </if>
      <if test="yxbs != null" >
        #{yxbs,jdbcType=DECIMAL},
      </if>
      <if test="fBbid != null" >
        #{fBbid,jdbcType=VARCHAR},
      </if>
      <if test="bBbid != null" >
        #{bBbid,jdbcType=VARCHAR},
      </if>
      <if test="zdbmid != null" >
        #{zdbmid,jdbcType=VARCHAR},
      </if>
      <if test="zdrid != null" >
        #{zdrid,jdbcType=VARCHAR},
      </if>
      <if test="zdsj != null" >
        #{zdsj,jdbcType=TIMESTAMP},
      </if>
      <if test="cmph != null" >
        #{cmph,jdbcType=VARCHAR},
      </if>
      <if test="wz != null" >
        #{wz,jdbcType=DECIMAL},
      </if>
      <if test="jgms != null" >
        #{jgms,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    update B_G2_012
    <set >
      <if test="jx != null" >
        JX = #{jx,jdbcType=VARCHAR},
      </if>
      <if test="wxfabh != null" >
        WXFABH = #{wxfabh,jdbcType=VARCHAR},
      </if>
      <if test="wxxmdlid != null" >
        WXXMDLID = #{wxxmdlid,jdbcType=VARCHAR},
      </if>
      <if test="wxxmlx != null" >
        WXXMLX = #{wxxmlx,jdbcType=DECIMAL},
      </if>
      <if test="zjh != null" >
        ZJH = #{zjh,jdbcType=VARCHAR},
      </if>
      <if test="rwh != null" >
        RWH = #{rwh,jdbcType=VARCHAR},
      </if>
      <if test="bb != null" >
        BB = #{bb,jdbcType=DECIMAL},
      </if>
      <if test="ckh != null" >
        CKH = #{ckh,jdbcType=VARCHAR},
      </if>
      <if test="rwms != null" >
        RWMS = #{rwms,jdbcType=VARCHAR},
      </if>
      <if test="syx != null" >
        SYX = #{syx,jdbcType=VARCHAR},
      </if>
      <if test="ckwj != null" >
        CKWJ = #{ckwj,jdbcType=VARCHAR},
      </if>
      <if test="gzlx != null" >
        GZLX = #{gzlx,jdbcType=VARCHAR},
      </if>
      <if test="xmlx != null" >
        XMLX = #{xmlx,jdbcType=VARCHAR},
      </if>
      <if test="isBj != null" >
        IS_BJ = #{isBj,jdbcType=DECIMAL},
      </if>
      <if test="ali != null" >
        ALI = #{ali,jdbcType=DECIMAL},
      </if>
      <if test="jhgsRs != null" >
        JHGS_RS = #{jhgsRs,jdbcType=DECIMAL},
      </if>
      <if test="jhgsXss != null" >
        JHGS_XSS = #{jhgsXss,jdbcType=DECIMAL},
      </if>
      <if test="gkbh != null" >
        GKBH = #{gkbh,jdbcType=VARCHAR},
      </if>
      <if test="eobh != null" >
        EOBH = #{eobh,jdbcType=VARCHAR},
      </if>
      <if test="jsgs != null" >
        JSGS = #{jsgs,jdbcType=DECIMAL},
      </if>
      <if test="isHdwz != null" >
        IS_HDWZ = #{isHdwz,jdbcType=DECIMAL},
      </if>
      <if test="bz != null" >
        BZ = #{bz,jdbcType=VARCHAR},
      </if>
      <if test="zt != null" >
        ZT = #{zt,jdbcType=DECIMAL},
      </if>
      <if test="yxbs != null" >
        YXBS = #{yxbs,jdbcType=DECIMAL},
      </if>
      <if test="fBbid != null" >
        F_BBID = #{fBbid,jdbcType=VARCHAR},
      </if>
      <if test="bBbid != null" >
        B_BBID = #{bBbid,jdbcType=VARCHAR},
      </if>
      <if test="zdbmid != null" >
        ZDBMID = #{zdbmid,jdbcType=VARCHAR},
      </if>
      <if test="zdrid != null" >
        ZDRID = #{zdrid,jdbcType=VARCHAR},
      </if>
      <if test="zdsj != null" >
        ZDSJ = #{zdsj,jdbcType=TIMESTAMP},
      </if>
      <if test="cmph != null" >
        CMPH = #{cmph,jdbcType=VARCHAR},
      </if>
      <if test="wz != null" >
	    WZ = #{wz,jdbcType=DECIMAL}
      </if>
      <if test="jgms != null" >
        JGMS = #{jgms,jdbcType=VARCHAR},
      </if>
    </set>
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    update B_G2_012
    set 
      JX = #{jx,jdbcType=VARCHAR},
      WXFABH = #{wxfabh,jdbcType=VARCHAR},
      WXXMDLID = #{wxxmdlid,jdbcType=VARCHAR},
      WXXMLX = #{wxxmlx,jdbcType=DECIMAL},
      ZJH = #{zjh,jdbcType=VARCHAR},
      RWH = #{rwh,jdbcType=VARCHAR},
      BB = #{bb,jdbcType=DECIMAL},
      CKH = #{ckh,jdbcType=VARCHAR},
      RWMS = #{rwms,jdbcType=VARCHAR},
      SYX = #{syx,jdbcType=VARCHAR},
      CKWJ = #{ckwj,jdbcType=VARCHAR},
      GZLX = #{gzlx,jdbcType=VARCHAR},
      XMLX = #{xmlx,jdbcType=VARCHAR},
      IS_BJ = #{isBj,jdbcType=DECIMAL},
      ALI = #{ali,jdbcType=DECIMAL},
      JHGS_RS = #{jhgsRs,jdbcType=DECIMAL},
      JHGS_XSS = #{jhgsXss,jdbcType=DECIMAL},
      GKBH = #{gkbh,jdbcType=VARCHAR},
      EOBH = #{eobh,jdbcType=VARCHAR},
      JSGS = #{jsgs,jdbcType=DECIMAL},
      IS_HDWZ = #{isHdwz,jdbcType=DECIMAL},
      BZ = #{bz,jdbcType=VARCHAR},
      ZT = #{zt,jdbcType=DECIMAL},
      YXBS = #{yxbs,jdbcType=DECIMAL},
      F_BBID = #{fBbid,jdbcType=VARCHAR},
      B_BBID = #{bBbid,jdbcType=VARCHAR},
      ZDBMID = #{zdbmid,jdbcType=VARCHAR},
      ZDRID = #{zdrid,jdbcType=VARCHAR},
      ZDSJ = #{zdsj,jdbcType=TIMESTAMP},
      CMPH = #{cmph,jdbcType=VARCHAR},
      WZ = #{wz,jdbcType=DECIMAL},
      JGMS = #{jgms,jdbcType=VARCHAR}
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  
  <sql id="Common_Param">
	   WHERE 
	   1=1
	   <!-- 有效标识 -->
	   <if test="yxbs != null" >
       	   AND B1.YXBS = #{yxbs,jdbcType=DECIMAL}
       </if>
	   <!-- 维修项目类型 -->
   	   <if test="paramsMap != null and paramsMap.wxxmlxList != null">
   	   		<if test="paramsMap.wxxmlxList.size > 0">
			    AND B1.WXXMLX IN
	   			<foreach item="item" index="index" collection="paramsMap.wxxmlxList" open="(" separator="," close=")">  
	       			#{item}  
	   			</foreach>  
   	   		</if>
   	   		<if test="paramsMap.wxxmlxList.size == 0">
			    AND 1 = 0
   	   		</if>
	   </if>
       <!-- 关键字 -->
   	   <if test="paramsMap != null and paramsMap.keyword != null and paramsMap.keyword != ''">
          and  (
          		UPPER(b1.rwh) like UPPER('%'||#{paramsMap.keyword}||'%')  or
          	    UPPER(b1.CKH) like UPPER('%'||#{paramsMap.keyword}||'%') or
          	    UPPER(b1.rwms) like UPPER('%'||#{paramsMap.keyword}||'%') or
          	    UPPER(b1.ckwj) like UPPER('%'||#{paramsMap.keyword}||'%') or
          	    UPPER(b6.bjh) like UPPER('%'||#{paramsMap.keyword}||'%')
          	)
       </if>
       <if test="paramsMap != null and paramsMap.queryId != null and paramsMap.queryId != ''" >
       	   AND b1.id = #{paramsMap.queryId}
       </if>
       <!-- 适用性 -->
       <if test="paramsMap != null and paramsMap.syx != null and paramsMap.syx != ''" >
       	   and (b1.syx = '00000' or 
       	   		exists (select 1 from b_g2_01203 param1 where param1.mainid = b1.id and param1.fjzch = #{paramsMap.syx}))
       </if>
  </sql>
  
  <!-- 根据维修方案查询生效的维修项目 -->
  <select id="queryEffective" resultMap="MaintenanceProjectJoinMap" 
  		parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
	    SELECT B1.ID,
	       B1.WXXMLX,
	       B1.ZJH,
	       B1.RWH,
	       B1.BB,
	       B1.CKH,
	       B1.RWMS,
	       B1.SYX,
	       B1.CKWJ,
	       B1.GZLX,
	       B1.XMLX,
	       B1.IS_BJ,
	       B1.ALI,
	       B1.JHGS_RS,
	       B1.JHGS_XSS,
	       B1.GKBH,
	       B1.BZ,
	       B1.ZT,
	       B1.ZDSJ,
	       B1.YXBS,
	       B1.F_BBID,
	       B1.EOBH,
	       D1.ZJH AS D1ZJH,
	       D1.ZWMS AS D1ZWMS,
	       D1.YWMS AS D1YWMS,
	       B3.ID AS B3ID,
	       B3.DLBH AS B3DLBH,
	       B3.DLZWMS AS B3DLZWMS,
	       B3.DLYWMS AS B3DLYWMS,
	       B4.ID AS B4ID,
	       B4.JKLBH AS B4JKLBH,
	       B4.SCZ AS B4SCZ,
	       B4.DW_SCZ AS B4DW_SCZ,
	       B4.ZQZ AS B4ZQZ,
	       B4.DW_ZQZ AS B4DW_ZQZ,
	       B4.YDZ_Q AS B4YDZ_Q,
	       B4.YDZ_QDW AS B4YDZ_QDW,
	       B4.YDZ_H AS B4YDZ_H,
	       B5.ID AS B5ID,
	       B5.FJZCH AS B5FJZCH,
	       <if test="paramsMap != null and paramsMap.relatePart != null and paramsMap.relatePart == 1">
	       B6.BJH AS B4BJH,
	       </if>
	       (SELECT 1
	          FROM D_011 D011
	         WHERE D011.MAINID = B1.ID
	           AND ROWNUM = 1) ATTACHCOUNT,
	       U1.ID AS ZDRID,
	       U1.USERNAME AS ZDRUSERNAME,
	       U1.REALNAME AS ZDRREALNAME,
	       G2995.QYSTR,
       	   G2995.JJSTR,
           G2995.FJZWSTR
	  FROM B_G2_01102 F2
	 INNER JOIN B_G2_012 B1
	    ON F2.WXXMID = B1.ID
	   AND F2.MAINID = #{id,jdbcType=VARCHAR}
	  LEFT JOIN D_005 D1
	    ON B1.ZJH = D1.ZJH
	   AND B1.DPRTCODE = D1.DPRTCODE
	   AND D1.ZT = 1
	  LEFT JOIN B_G2_01101 B3
	    ON B1.WXXMDLID = B3.ID
	  LEFT JOIN B_G2_01201 B4
	    ON B1.ID = B4.MAINID
	   AND B4.ZT = 1
	  LEFT JOIN B_G2_01203 B5
	    ON B1.ID = B5.MAINID
	  LEFT JOIN B_G2_01204 B6 ON B4.JKDXID = B6.ID
	  LEFT JOIN T_USER U1
	    ON B1.ZDRID = U1.ID
	  LEFT JOIN (SELECT WM_CONCAT(G2995.QYSTR) QYSTR,
                    WM_CONCAT(G2995.JJSTR) JJSTR,
                    WM_CONCAT(G2995.FJZWSTR) FJZWSTR,
                    G2995.YWID
               FROM (SELECT (CASE
                              WHEN G2995.LX = 1 THEN
                               G2995.GBH
                              ELSE
                               NULL
                            END) QYSTR,
                            (CASE
                              WHEN G2995.LX = 2 THEN
                               G2995.GBH || ' ' || D_021.GBMC
                              ELSE
                               NULL
                            END) JJSTR,
                            (CASE
                              WHEN G2995.LX = 3 THEN
                               G2995.GBH
                              ELSE
                               NULL
                            END) FJZWSTR,
                            G2995.YWID
                       FROM B_G2_995 G2995
                       LEFT JOIN D_021 D_021
                         ON G2995.GBID = D_021.ID
                        AND G2995.LX = 2
                      WHERE G2995.YWLX = 3) G2995
              GROUP BY G2995.YWID) G2995
    ON G2995.YWID = B1.ID
    <include refid="Common_Param"></include>
    <if test="paramsMap != null and paramsMap.type == 1">
    	ORDER BY B1.ZJH, B1.RWH, B4.JKLBH, B5.FJZCH,B1.ID
    </if>
    <if test="paramsMap != null and paramsMap.type == 2">
    	ORDER BY B3.XC, B3.DLBH, B1.RWH, B4.JKLBH, B5.FJZCH,B1.ID
    </if>
  </select>
  
  <!-- 根据维修方案查询未生效的维修项目 -->
  <select id="queryIneffective" resultMap="MaintenanceProjectJoinMap" 
  		parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
	    SELECT B1.ID,
	       B1.WXXMLX,
	       B1.ZJH,
	       B1.RWH,
	       B1.BB,
	       B1.CKH,
	       B1.RWMS,
	       B1.SYX,
	       B1.CKWJ,
	       B1.GZLX,
	       B1.XMLX,
	       B1.IS_BJ,
	       B1.ALI,
	       B1.JHGS_RS,
	       B1.JHGS_XSS,
	       B1.GKBH,
	       B1.BZ,
	       B1.ZT,
	       B1.ZDSJ,
	       B1.F_BBID,
	       B1.YXBS,
	       B1.EOBH,
	       D1.ZJH AS D1ZJH,
	       D1.ZWMS AS D1ZWMS,
	       D1.YWMS AS D1YWMS,
	       B3.DLBH AS B3DLBH,
	       B3.DLZWMS AS B3DLZWMS,
	       B3.DLYWMS AS B3DLYWMS,
	       B4.ID AS B4ID,
	       B4.JKLBH AS B4JKLBH,
	       B4.SCZ AS B4SCZ,
	       B4.DW_SCZ AS B4DW_SCZ,
	       B4.ZQZ AS B4ZQZ,
	       B4.DW_ZQZ AS B4DW_ZQZ,
	       B4.YDZ_Q AS B4YDZ_Q,
	       B4.YDZ_QDW AS B4YDZ_QDW,
	       B4.YDZ_H AS B4YDZ_H,
	       B5.ID AS B5ID,
	       B5.FJZCH AS B5FJZCH,
	       <if test="paramsMap != null and paramsMap.relatePart != null and paramsMap.relatePart == 1">
	       B6.BJH AS B4BJH,
	       </if>
	       (SELECT 1
	          FROM D_011 D011
	         WHERE D011.MAINID = B1.ID
	           AND ROWNUM = 1) ATTACHCOUNT,
	       U1.ID AS ZDRID,
	       U1.USERNAME AS ZDRUSERNAME,
	       U1.REALNAME AS ZDRREALNAME,
	       G2995.QYSTR,
       	   G2995.JJSTR,
       	   G2995.FJZWSTR
	  FROM B_G2_012 B1
	  LEFT JOIN D_005 D1
	    ON B1.DPRTCODE = D1.DPRTCODE
	   AND D1.ZT = 1
	   AND B1.ZJH = D1.ZJH
	  LEFT JOIN B_G2_01101 B3
	    ON B1.WXXMDLID = B3.ID
	  LEFT JOIN B_G2_01201 B4
	    ON B1.ID = B4.MAINID
	   AND B4.ZT = 1
	  LEFT JOIN B_G2_01203 B5
	    ON B1.ID = B5.MAINID
	  LEFT JOIN B_G2_01204 B6 ON B4.JKDXID = B6.ID
	  LEFT JOIN (SELECT WM_CONCAT(G2995.QYSTR) QYSTR,
                    WM_CONCAT(G2995.JJSTR) JJSTR,
                    WM_CONCAT(G2995.FJZWSTR) FJZWSTR,
                    G2995.YWID
               FROM (SELECT (CASE
                              WHEN G2995.LX = 1 THEN
                               G2995.GBH
                              ELSE
                               NULL
                            END) QYSTR,
                            (CASE
                              WHEN G2995.LX = 2 THEN
                               G2995.GBH || ' ' || D_021.GBMC
                              ELSE
                               NULL
                            END) JJSTR,
                            (CASE
                              WHEN G2995.LX = 3 THEN
                               G2995.GBH
                              ELSE
                               NULL
                            END) FJZWSTR,
                            G2995.YWID
                       FROM B_G2_995 G2995
                       LEFT JOIN D_021 D_021
                         ON G2995.GBID = D_021.ID
                        AND G2995.LX = 2
                      WHERE G2995.YWLX = 3) G2995
              GROUP BY G2995.YWID) G2995
    ON G2995.YWID = B1.ID
	  LEFT JOIN T_USER U1
	    ON B1.ZDRID = U1.ID
    <include refid="Common_Param"></include>
	    AND B1.DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
	    AND B1.BB &lt;= #{bb,jdbcType=DECIMAL} 
	    AND COALESCE(B1.B_BBID, '-') = '-'
   		AND B1.WXFABH = #{wxfabh,jdbcType=VARCHAR} 
    <if test="paramsMap != null and paramsMap.type == 1">
    	ORDER BY B1.ZJH, B1.RWH, B4.JKLBH, B5.FJZCH,B1.ID
    </if>
    <if test="paramsMap != null and paramsMap.type == 2">
    	ORDER BY B3.XC, B3.DLBH, B1.RWH, B4.JKLBH, B5.FJZCH,B1.ID
    </if>
  </select>
  
  <!-- 查询生效的维修项目的相关维修项目 -->
  <select id="queryqueryEffectiveRelated" resultMap="MaintenanceProjectJoinMap" 
  		parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    SELECT 
	    B1.ID, B1.DPRTCODE, B1.JX, B1.WXFABH, B1.WXXMDLID, B1.WXXMLX, B1.ZJH, B1.RWH, B1.BB, 
	    B1.CKH, B1.RWMS, B1.SYX, B1.CKWJ, B1.GZLX, B1.XMLX, B1.IS_BJ, B1.ALI, 
	    B1.JHGS_RS, B1.JHGS_XSS, B1.GKBH, B1.JSGS, B1.IS_HDWZ, B1.BZ, B1.ZT, B1.F_BBID, 
	    B1.B_BBID, B1.ZDBMID, B1.ZDRID, B1.ZDSJ, B1.YXBS,
	    B5.ID AS B5ID, B5.FJZCH AS B5FJZCH, 
    	B6.ID AS CP_ID, B6.LX AS CP_LX, B6.GBID AS CP_GBID, B6.GBH AS CP_GBH, B6.XC AS CP_XC,
		B6D1.ID AS CPI_ID, B6D1.GBBH AS CPI_GBBH, B6D1.GBMC AS CPI_GBMC
    FROM B_G2_012 B1
      LEFT JOIN B_G2_01203 B5 ON B1.ID = B5.MAINID
      LEFT JOIN B_G2_995 B6 ON B1.ID = B6.YWID
      LEFT JOIN D_021 B6D1 ON B6.GBID= B6D1.ID
    	WHERE EXISTS(
    		SELECT 1 FROM B_G2_01103 B2 
    			WHERE B2.WXXMID = #{id,jdbcType=VARCHAR}
    			  AND B2.XGWXXMID = B1.ID
    			   AND B2.MAINID = #{scheme.id,jdbcType=VARCHAR}
    	) OR (EXISTS(
    		SELECT 1 FROM B_G2_01103 B2
    			WHERE B2.XGWXXMID = #{id,jdbcType=VARCHAR}
    			  AND B2.WXXMID = B1.ID
    			  AND B2.MAINID = #{scheme.id,jdbcType=VARCHAR}
    	) AND B1.WXXMLX = 4 AND B1.YXBS = 1)
      <choose>
	 	<when test='pagination.sort == "auto"'>
		    ORDER BY B1.RWH, B1.CKH, B5.FJZCH, B6.GBH
	 	</when>
	 	<otherwise>
		    ORDER BY B1.${pagination.sort} ${pagination.order}, B5.FJZCH, B6.GBH
	 	</otherwise>
	  </choose>	
  </select>
  
  <!-- 查询未生效的维修项目的相关维修项目 -->
  <select id="queryqueryIneffectiveRelated" resultMap="MaintenanceProjectJoinMap" 
  		parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    SELECT 
	    B1.ID, B1.DPRTCODE, B1.JX, B1.WXFABH, B1.WXXMDLID, B1.WXXMLX, B1.ZJH, B1.RWH, B1.BB, 
	    B1.CKH, B1.RWMS, B1.SYX, B1.CKWJ, B1.GZLX, B1.XMLX, B1.IS_BJ, B1.ALI, 
	    B1.JHGS_RS, B1.JHGS_XSS, B1.GKBH, B1.JSGS, B1.IS_HDWZ, B1.BZ, B1.ZT, B1.F_BBID, 
	    B1.B_BBID, B1.ZDBMID, B1.ZDRID, B1.ZDSJ, B1.YXBS,
	    B5.ID AS B5ID, B5.FJZCH AS B5FJZCH, 
    	B6.ID AS CP_ID, B6.LX AS CP_LX, B6.GBID AS CP_GBID, B6.GBH AS CP_GBH, B6.XC AS CP_XC,
		B6D1.ID AS CPI_ID, B6D1.GBBH AS CPI_GBBH, B6D1.GBMC AS CPI_GBMC
    FROM B_G2_012 B1
      LEFT JOIN B_G2_01203 B5 ON B1.ID = B5.MAINID
      LEFT JOIN B_G2_995 B6 ON B1.ID = B6.YWID
      LEFT JOIN D_021 B6D1 ON B6.GBID= B6D1.ID
    	WHERE (EXISTS(
    		SELECT 1 FROM B_G2_01202 B2 
    			WHERE B2.WXXMBH = B1.RWH
    			  AND B2.JX = B1.JX
    			  AND B2.MAINID = #{id,jdbcType=VARCHAR}
    	)
    	OR (EXISTS(
    		SELECT 1 FROM b_g2_01202 B2
    			WHERE B2.WXXMBH = #{rwh,jdbcType=VARCHAR}
    			  AND B2.MAINID = B1.ID
    	) AND B1.WXXMLX = 4 AND B1.YXBS = 1))
    	AND B1.WXFABH = #{wxfabh,jdbcType=VARCHAR} AND B1.DPRTCODE = #{dprtcode,jdbcType=VARCHAR} AND B1.B_BBID IS NULL
      <choose>
	 	<when test='pagination.sort == "auto"'>
		    ORDER BY B1.RWH, B1.CKH, B5.FJZCH, B6.GBH
	 	</when>
	 	<otherwise>
		    ORDER BY B1.${pagination.sort} ${pagination.order}, B5.FJZCH, B6.GBH
	 	</otherwise>
	  </choose>	
  </select>
  
  <!-- 查询监控项目版本 -->
  <select id="queryMonitorItemVersion" resultMap="MaintenanceProjectJoinMap" 
  		parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    SELECT 
	    B1.ID, B1.DPRTCODE, B1.JX, B1.WXFABH, B1.WXXMDLID, B1.WXXMLX, B1.ZJH, B1.RWH, B1.BB, 
	    B1.CKH, B1.RWMS, B1.SYX, B1.CKWJ, B1.GZLX, B1.XMLX, B1.IS_BJ, B1.ALI, 
	    B1.JHGS_RS, B1.JHGS_XSS, B1.GKBH, B1.JSGS, B1.IS_HDWZ, B1.BZ, B1.ZT, B1.F_BBID, 
	    B1.B_BBID, B1.ZDBMID, B1.ZDRID, B1.ZDSJ, B1.YXBS, 
	    W.ID AS WID, W.DPRTCODE AS WDPRTCODE, W.JX AS WJX, W.WXFABH AS WWXFABH, W.BB AS WBB, W.ZXBS AS WZXBS,
	    B4.ID AS B4ID, B4.JKLBH AS B4JKLBH, B4.JKFLBH AS B4JKFLBH, B4.SCZ AS B4SCZ, B4.DW_SCZ AS B4DW_SCZ,
	    B4.ZQZ AS B4ZQZ, B4.DW_ZQZ AS B4DW_ZQZ, B4.YDZ_Q AS B4YDZ_Q, B4.YDZ_QDW AS B4YDZ_QDW, B4.YDZ_H AS B4YDZ_H,
	    B4.YDZ_HDW AS B4YDZ_HDW, B7.BJH AS B4BJH,
	    B4D1.JKFLBH AS B4D1JKFLBH, B4D1.MS AS B4D1MS, B4D1.PXH AS B4D1PXH,
	    B4D2.JKLBH AS B4D2JKLBH, B4D2.MS AS B4D2MS, B4D2.PXH AS B4D2PXH, B4D2.JKFLBH AS B4D2JKFLBH
    FROM B_G2_012 B1
      LEFT JOIN B_G2_01102 F ON B1.ID = F.WXXMID
      LEFT JOIN B_G2_011 W ON F.MAINID = W.ID
      INNER JOIN B_G2_01201 B4 ON B1.ID = B4.MAINID AND B4.ZT = 1
      LEFT JOIN B_G2_01204 B7 ON B4.JKDXID = B7.ID
      LEFT JOIN D_006 B4D1 ON B4.JKFLBH = B4D1.JKFLBH
      LEFT JOIN D_00601 B4D2 ON B4.JKLBH = B4D2.JKLBH
      INNER JOIN B_G2_012 SELF ON ((B1.JX = SELF.JX AND B1.DPRTCODE = SELF.DPRTCODE AND B1.RWH = SELF.RWH
      				AND SELF.ID = #{id,jdbcType=VARCHAR} AND B1.BB &lt; SELF.BB) OR (
      								SELF.ID = #{id,jdbcType=VARCHAR} AND B1.ID = SELF.ID))
      ORDER BY B1.BB DESC, B7.BJH, B4.JKLBH asc
  </select>
  
   	<!-- 根据查询条件分页查询维修项目信息(弹窗需要的数据) -->
  	<select id="queryWinAllPageList" resultMap="MaintenanceProjectJoinMap" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
		SELECT 
			B1.ID, B1.DPRTCODE, B1.JX, B1.WXFABH, B1.WXXMDLID, B1.WXXMLX, B1.ZJH, B1.RWH, B1.BB, 
		    B1.CKH, B1.RWMS, B1.SYX, B1.CKWJ, B1.GZLX, B1.XMLX, B1.IS_BJ, B1.ALI, 
		    B1.JHGS_RS, B1.JHGS_XSS, B1.GKBH, B1.JSGS, B1.IS_HDWZ, B1.BZ, B1.ZT, B1.F_BBID, 
		    B1.B_BBID, B1.ZDBMID, B1.ZDRID, B1.ZDSJ
		FROM B_G2_012 B1
		WHERE B1.B_BBID IS NULL 
		  AND B1.WXXMLX != 4 
		  AND B1.YXBS = 1
		  AND B1.JX = #{jx,jdbcType=VARCHAR}
		  AND B1.WXFABH = #{wxfabh,jdbcType=VARCHAR} 
		  AND B1.DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
		  <if test="wxxmlx == 4">
		  AND NOT EXISTS (
			  SELECT 1 FROM B_G2_012 T1
			    INNER JOIN B_G2_01202 T2 ON T1.ID = T2.MAINID
			  WHERE T2.WXXMBH = B1.RWH 
			    AND T2.ZT = 1 
			    AND T1.YXBS = 1
			    AND T1.B_BBID IS NULL
			    AND T1.DPRTCODE = B1.DPRTCODE 
			    AND T1.JX = B1.JX 
			    AND T1.WXFABH = B1.WXFABH 
				AND T1.WXXMLX = 4
			    <if test="id != null and id != ''">
				    AND T1.ID != #{id,jdbcType=VARCHAR}
				</if>
		  )
		  </if>
		<if test="paramsMap != null and paramsMap.keyword != null and paramsMap.keyword != ''">
		    and (
		    	UPPER(B1.RWH) like UPPER('%'||#{paramsMap.keyword}||'%')
		    	or UPPER(B1.CKH) like UPPER('%'||#{paramsMap.keyword}||'%')
		    )
		</if>
		
		<if test="paramsMap != null and paramsMap.codeList != null and paramsMap.codeList != ''">
		    AND B1.RWH NOT IN
     			 <foreach item="item" index="index" collection="paramsMap.codeList" open="(" separator="," close=")">  
          			#{item}  
     			 </foreach>  
		</if>
		
		<!-- order by ID asc -->
	  	<choose><!--  进行排序判断，如果默认就是默认字段排序 -->
	    	<when test='pagination.sort == "auto"'>                       
	    		ORDER BY B1.RWH
	    	</when>
	    	<otherwise>
			    ORDER BY ${pagination.sort} ${pagination.order}
	    	</otherwise>
		</choose>
		
  	</select>
  	
  	
  	<!-- 根据查询条件分页查询维修项目信息(工卡弹窗需要的数据) -->
  	<select id="queryWinAllPageList4WorkCard" resultMap="MaintenanceProjectJoinMap" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
		SELECT 
			B.ID, 
			B.DPRTCODE, 
			B.JX, 
			B.WXFABH, 
			B.WXXMDLID, 
			B.WXXMLX, 
			B.ZJH, 
			B.RWH, 
			B.BB, 
			B.CKH, 
			B.RWMS, 
			B.SYX, 
			B.CKWJ, 
			B.GZLX, 
			B.XMLX, 
			B.IS_BJ, 
    		B.ALI, 
    		B.JHGS_RS, 
    		B.JHGS_XSS, 
    		B.GKBH, 
    		B.JSGS, 
    		B.IS_HDWZ, 
    		B.BZ, 
    		B.ZT, 
    		B.F_BBID, 
    		B.B_BBID, 
    		B.ZDBMID, 
    		B.ZDRID, 
    		B.ZDSJ,
    		D005.ZJH AS D1ZJH,
    		D005.ZWMS AS D1ZWMS,
    		D005.YWMS AS D1YWMS
  		from B_G2_012 B
  		join B_G2_01102 t2
  		on t2.wxxmid = B.ID
  		join B_G2_011 t1 
  		on t1.id = t2.mainid and t1.jx = #{jx,jdbcType=VARCHAR} and t1.zxbs = 2
  		LEFT JOIN D_005 D005 on B.DPRTCODE = D005.DPRTCODE and B.ZJH = D005.ZJH
 		where B.wxxmlx in (1, 2, 3) and B.yxbs = 1 and B.DPRTCODE = #{dprtcode,jdbcType=VARCHAR} and B.jx = #{jx,jdbcType=VARCHAR}
 			and not exists (select 1
	          	from b_g2_013 t
	         	where t.jx = #{jx,jdbcType=VARCHAR}
	            and t.WXXMBH = B.RWH
	            and t.DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
	            and t.zt != 8 and t.zxbs in (1,2) 
	           	<if test="gkbh != null and gkbh != ''" >
	        		and t.gkh != #{gkbh,jdbcType=VARCHAR}
	      		</if>
			)
			<if test="paramsMap != null and paramsMap.keyword != null and paramsMap.keyword != ''">
			    and (
			    	UPPER(B.RWH) like UPPER('%'||#{paramsMap.keyword}||'%')
			    	or UPPER(B.CKH) like UPPER('%'||#{paramsMap.keyword}||'%')
			    )
			</if> 
			<!-- order by ID asc -->
		  	<choose><!--  进行排序判断，如果默认就是默认字段排序 -->
		    	<when test='pagination.sort == "auto"'>                       
		    		ORDER BY B.RWH
		    	</when>
		    	<otherwise>
				    ORDER BY ${pagination.sort} ${pagination.order}
		    	</otherwise>
			</choose>
		
  	</select>
  	
  	
  	<!-- 根据查询条件查询定检包信息 -->
  	<select id="queryFixedPackageByWxfn" resultMap="MaintenanceProjectJoinMap" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
		select <include refid="Maintenance_Project_Column_List" />
		from B_G2_012 B
		where B.B_BBID is null and B.ZT in (1,2,3) and B.WXXMLX = 4
		<if test="dprtcode != null">
		    and B.DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
		</if>
		<if test="jx != null and jx != ''">
			and B.JX=#{jx,jdbcType=VARCHAR}
		</if>
		<if test="wxfabh != null and jx != ''">
			and B.WXFABH = #{wxfabh,jdbcType=VARCHAR} 
		</if>
	    order by B.ZDSJ DESC
		
  	</select>
  	
  	<!-- 查询差异导出数据 -->
  	<select id="queryExportExcelList" resultMap="MaintenanceProjectJoinMap" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
	    SELECT * FROM (
		    SELECT B1.ID,
		       B1.WXXMLX,
		       B1.WXXMDLID,
		       B1.ZJH,
		       B1.RWH,
		       B1.BB,
		       B1.CKH,
		       B1.RWMS,
		       B1.SYX,
		       B1.CKWJ,
		       B1.GZLX,
		       B1.XMLX,
		       B1.IS_BJ,
		       B1.ALI,
		       B1.JHGS_RS,
		       B1.JHGS_XSS,
		       B1.GKBH,
		       B1.BZ,
		       B1.ZT,
		       B1.ZDSJ,
		       B1.F_BBID,
		       B1.YXBS,
		       B1.EOBH,
		       D1.ZJH AS D1ZJH,
		       D1.ZWMS AS D1ZWMS,
		       D1.YWMS AS D1YWMS,
		       B3.DLBH AS B3DLBH,
		       B3.DLZWMS AS B3DLZWMS,
		       B3.DLYWMS AS B3DLYWMS,
		       B4.ID AS B4ID,
		       B4.JKLBH AS B4JKLBH,
		       B4.SCZ AS B4SCZ,
		       B4.DW_SCZ AS B4DW_SCZ,
		       B4.ZQZ AS B4ZQZ,
		       B4.DW_ZQZ AS B4DW_ZQZ,
		       B4.YDZ_Q AS B4YDZ_Q,
		       B4.YDZ_QDW AS B4YDZ_QDW,
		       B4.YDZ_H AS B4YDZ_H,
		       B5.ID AS B5ID,
		       B5.FJZCH AS B5FJZCH,
		       B6.BJH AS B4BJH,
		       (SELECT 1
		          FROM D_011 D011
		         WHERE D011.MAINID = B1.ID
		           AND ROWNUM = 1) ATTACHCOUNT,
		       U1.ID AS ZDRID,
		       U1.USERNAME AS ZDRUSERNAME,
		       U1.REALNAME AS ZDRREALNAME,
		       G2995.QYSTR,
	       	   G2995.JJSTR,
	       	   G2995.FJZWSTR,
	       	   (CASE
                   WHEN B1.YXBS = 1 and B1.F_BBID is null THEN '新增'
                   WHEN B1.YXBS = 1 and B1.F_BBID is not null THEN '改版'
                   WHEN B1.YXBS = 0 THEN '删除'
                   ELSE
                    ''
                 END) OPERATOR
		  FROM B_G2_012 B1
		  LEFT JOIN D_005 D1
		    ON B1.DPRTCODE = D1.DPRTCODE
		   AND D1.ZT = 1
		   AND B1.ZJH = D1.ZJH
		  LEFT JOIN B_G2_01101 B3
		    ON B1.WXXMDLID = B3.ID
		  LEFT JOIN B_G2_01201 B4
		    ON B1.ID = B4.MAINID
		   AND B4.ZT = 1
		  LEFT JOIN B_G2_01203 B5
		    ON B1.ID = B5.MAINID
		  LEFT JOIN B_G2_01204 B6 ON B4.JKDXID = B6.ID
		  LEFT JOIN (SELECT WM_CONCAT(G2995.QYSTR) QYSTR,
	                    WM_CONCAT(G2995.JJSTR) JJSTR,
	                    WM_CONCAT(G2995.FJZWSTR) FJZWSTR,
	                    G2995.YWID
	               FROM (SELECT (CASE
	                              WHEN G2995.LX = 1 THEN
	                               G2995.GBH
	                              ELSE
	                               NULL
	                            END) QYSTR,
	                            (CASE
	                              WHEN G2995.LX = 2 THEN
	                               G2995.GBH || ' ' || D_021.GBMC
	                              ELSE
	                               NULL
	                            END) JJSTR,
	                            (CASE
	                              WHEN G2995.LX = 3 THEN
	                               G2995.GBH
	                              ELSE
	                               NULL
	                            END) FJZWSTR,
	                            G2995.YWID
	                       FROM B_G2_995 G2995
	                       LEFT JOIN D_021 D_021
	                         ON G2995.GBID = D_021.ID
	                        AND G2995.LX = 2
	                      WHERE G2995.YWLX = 3) G2995
	              GROUP BY G2995.YWID) G2995
	    ON G2995.YWID = B1.ID
		  LEFT JOIN T_USER U1
		    ON B1.ZDRID = U1.ID
		where B1.DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
		    AND B1.BB = #{bb,jdbcType=DECIMAL}
		    <!-- AND COALESCE(B1.B_BBID, '-') = '-' -->
	   		AND B1.WXFABH = #{wxfabh,jdbcType=VARCHAR} 
	   	union all
	   	SELECT B1.ID,
		       B1.WXXMLX,
		       B1.WXXMDLID,
		       B1.ZJH,
		       B1.RWH,
		       B1.BB,
		       B1.CKH,
		       B1.RWMS,
		       B1.SYX,
		       B1.CKWJ,
		       B1.GZLX,
		       B1.XMLX,
		       B1.IS_BJ,
		       B1.ALI,
		       B1.JHGS_RS,
		       B1.JHGS_XSS,
		       B1.GKBH,
		       B1.BZ,
		       B1.ZT,
		       B1.ZDSJ,
		       B1.F_BBID,
		       B1.YXBS,
		       B1.EOBH,
		       D1.ZJH AS D1ZJH,
		       D1.ZWMS AS D1ZWMS,
		       D1.YWMS AS D1YWMS,
		       B3.DLBH AS B3DLBH,
		       B3.DLZWMS AS B3DLZWMS,
		       B3.DLYWMS AS B3DLYWMS,
		       B4.ID AS B4ID,
		       B4.JKLBH AS B4JKLBH,
		       B4.SCZ AS B4SCZ,
		       B4.DW_SCZ AS B4DW_SCZ,
		       B4.ZQZ AS B4ZQZ,
		       B4.DW_ZQZ AS B4DW_ZQZ,
		       B4.YDZ_Q AS B4YDZ_Q,
		       B4.YDZ_QDW AS B4YDZ_QDW,
		       B4.YDZ_H AS B4YDZ_H,
		       B5.ID AS B5ID,
		       B5.FJZCH AS B5FJZCH,
		       B6.BJH AS B4BJH,
		       (SELECT 1
		          FROM D_011 D011
		         WHERE D011.MAINID = B1.ID
		           AND ROWNUM = 1) ATTACHCOUNT,
		       U1.ID AS ZDRID,
		       U1.USERNAME AS ZDRUSERNAME,
		       U1.REALNAME AS ZDRREALNAME,
		       G2995.QYSTR,
	       	   G2995.JJSTR,
	       	   G2995.FJZWSTR,
	       	   '' OPERATOR
		  FROM B_G2_012 B1
		  LEFT JOIN B_G2_012 BB
		  ON COALESCE(BB.F_BBID, '-') = B1.ID
		  LEFT JOIN D_005 D1
		    ON B1.DPRTCODE = D1.DPRTCODE
		   AND D1.ZT = 1
		   AND B1.ZJH = D1.ZJH
		  LEFT JOIN B_G2_01101 B3
		    ON B1.WXXMDLID = B3.ID
		  LEFT JOIN B_G2_01201 B4
		    ON B1.ID = B4.MAINID
		   AND B4.ZT = 1
		  LEFT JOIN B_G2_01203 B5
		    ON B1.ID = B5.MAINID
		  LEFT JOIN B_G2_01204 B6 ON B4.JKDXID = B6.ID
		  LEFT JOIN (SELECT WM_CONCAT(G2995.QYSTR) QYSTR,
	                    WM_CONCAT(G2995.JJSTR) JJSTR,
	                    WM_CONCAT(G2995.FJZWSTR) FJZWSTR,
	                    G2995.YWID
	               FROM (SELECT (CASE
	                              WHEN G2995.LX = 1 THEN
	                               G2995.GBH
	                              ELSE
	                               NULL
	                            END) QYSTR,
	                            (CASE
	                              WHEN G2995.LX = 2 THEN
	                               G2995.GBH || ' ' || D_021.GBMC
	                              ELSE
	                               NULL
	                            END) JJSTR,
	                            (CASE
	                              WHEN G2995.LX = 3 THEN
	                               G2995.GBH
	                              ELSE
	                               NULL
	                            END) FJZWSTR,
	                            G2995.YWID
	                       FROM B_G2_995 G2995
	                       LEFT JOIN D_021 D_021
	                         ON G2995.GBID = D_021.ID
	                        AND G2995.LX = 2
	                      WHERE G2995.YWLX = 3) G2995
	              GROUP BY G2995.YWID) G2995
	    ON G2995.YWID = B1.ID
		  LEFT JOIN T_USER U1
		    ON B1.ZDRID = U1.ID
		where BB.DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
		    AND BB.BB = #{bb,jdbcType=DECIMAL}
	   		AND BB.WXFABH = #{wxfabh,jdbcType=VARCHAR} 
   	) A
    ORDER BY A.RWH, A.BB desc
  </select>
  	
  	<!-- 维修项目生效 -->
  	<update id="effect" parameterType="com.eray.thjw.project2.po.MaintenanceScheme" >
		UPDATE B_G2_012 
			SET 
		      ZT = 3,
		      ZDBMID = #{zdbmid,jdbcType=VARCHAR},
		      ZDRID = #{zdrid,jdbcType=VARCHAR},
		      ZDSJ = #{zdsj,jdbcType=TIMESTAMP}
		    WHERE 
		      DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
		      AND JX = #{jx,jdbcType=VARCHAR}
		      AND WXFABH = #{wxfabh,jdbcType=VARCHAR}
		      AND ZT = 1
  	</update>
  	
  	<!-- 将维修项目工卡编号设为空 -->
  	<update id="updateGkbh2Null" parameterType="java.lang.String" >
		UPDATE B_G2_012 B SET B.GKBH = NULL
	    WHERE B.GKBH = #{gkbh,jdbcType=VARCHAR}
	      AND B.ID in (
	       		SELECT BG201102.WXXMID FROM B_G2_01102 BG201102
	       		JOIN B_G2_011 BG2011 ON BG2011.ID = BG201102.MAINID
	       		WHERE BG2011.DPRTCODE = #{dprtcode,jdbcType=VARCHAR} AND BG2011.JX = #{jx,jdbcType=VARCHAR} AND BG2011.ZXBS = 2
	        )
  	</update>
  	
  	<!-- 修改维修项目工卡编号 -->
  	<update id="updateGkbh" parameterType="java.lang.String" >
		UPDATE B_G2_012 B SET B.GKBH = #{gkbh,jdbcType=VARCHAR}
	    WHERE B.RWH = #{wxxmbh,jdbcType=VARCHAR}
	      AND B.ID in (
	       		SELECT BG201102.WXXMID FROM B_G2_01102 BG201102
	       		JOIN B_G2_011 BG2011 ON BG2011.ID = BG201102.MAINID
	       		WHERE BG2011.DPRTCODE = #{dprtcode,jdbcType=VARCHAR} AND BG2011.JX = #{jx,jdbcType=VARCHAR} AND BG2011.ZXBS = 2
	        )
  	</update>
  	
  	<!-- 将非生效状态维修项目工卡编号设为空 -->
  	<update id="updateGkbh2Null4NoEffective" parameterType="java.lang.String" >
		UPDATE B_G2_012 B SET B.GKBH = NULL
	    WHERE DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
	      AND JX = #{jx,jdbcType=VARCHAR}
	      AND GKBH = #{gkbh,jdbcType=VARCHAR}
	      AND B_BBID is null
	      AND ZT = 1
  	</update>
  	
  	<!-- 修改非生效状态维修项目工卡编号 -->
  	<update id="updateGkbh4NoEffective" parameterType="java.lang.String" >
		UPDATE B_G2_012 B SET B.GKBH = #{gkbh,jdbcType=VARCHAR}
	    WHERE DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
	      AND JX = #{jx,jdbcType=VARCHAR}
	      AND RWH = #{wxxmbh,jdbcType=VARCHAR}
	      AND B_BBID is null
	      AND ZT = 1
  	</update>
  
    <!-- 查询维修项目详情 -->
    <select id="queryDetail" resultMap="MaintenanceProjectJoinMap" 
  		parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
	    SELECT 
		    B1.ID, B1.DPRTCODE, B1.JX, B1.WXFABH, B1.WXXMDLID, B1.WXXMLX, B1.ZJH, B1.RWH, B1.BB, 
		    B1.CKH, B1.RWMS, B1.SYX, B1.CKWJ, B1.GZLX, B1.XMLX, B1.IS_BJ, B1.ALI, 
		    B1.JHGS_RS, B1.JHGS_XSS, B1.GKBH, B1.JSGS, B1.IS_HDWZ, B1.BZ, B1.ZT, B1.F_BBID, 
		    B1.B_BBID, B1.ZDBMID, B1.ZDRID, B1.ZDSJ, B1.YXBS, B1.EOBH, B1.CMPH, B1.WZ, B1.JGMS,
		    D1.ZJH AS D1ZJH,D1.ZWMS AS D1ZWMS,D1.YWMS AS D1YWMS,
		    W.ID AS WID, W.DPRTCODE AS WDPRTCODE, W.JX AS WJX, W.WXFABH AS WWXFABH, W.BB AS WBB, 
		    W.ZWMS AS WZWMS, W.ZXBS AS WZXBS, W.ZT AS WZT, W.GBYJ AS WGBYJ,
		    W1B3.ID AS TECID, W1B3.PGDZT AS TECPGDZT, W1B3.PGDH AS TECPGDH, W1B3.BB AS TECBB,
		    B2.ID AS B2ID, B2.BJH AS B2BJH, B2.CJ AS B2CJ,
		    B3.ID AS B3ID, B3.JX AS B3JX, B3.DLBH AS B3DLBH, B3.DLZWMS AS B3DLZWMS, B3.DLYWMS AS B3DLYWMS,
		    B4.ID AS B4ID, B4.JKLBH AS B4JKLBH, B4.JKFLBH AS B4JKFLBH, B4.SCZ AS B4SCZ, B4.DW_SCZ AS B4DW_SCZ,
		    B4.ZQZ AS B4ZQZ, B4.DW_ZQZ AS B4DW_ZQZ, B4.YDZ_Q AS B4YDZ_Q, B4.YDZ_QDW AS B4YDZ_QDW, B4.YDZ_H AS B4YDZ_H,
		    B4.YDZ_HDW AS B4YDZ_HDW, B7.BJH AS B4BJH, B7.CJ AS B4CJ,
		    B4D1.JKFLBH AS B4D1JKFLBH, B4D1.MS AS B4D1MS, B4D1.PXH AS B4D1PXH,
		    B4D2.JKLBH AS B4D2JKLBH, B4D2.MS AS B4D2MS, B4D2.PXH AS B4D2PXH, B4D2.JKFLBH AS B4D2JKFLBH,
		    B5.ID AS B5ID, B5.FJZCH AS B5FJZCH, 
		    B6.ID AS CP_ID, B6.LX AS CP_LX, B6.GBID AS CP_GBID, B6.GBH AS CP_GBH, B6.XC AS CP_XC,
		    B6D1.ID AS CPI_ID, B6D1.GBBH AS CPI_GBBH, B6D1.GBMC AS CPI_GBMC,
		    E.ID AS EID, E.EOBH AS EEOBH, E.BB AS EBB, E.EOZT AS EEOZT,
		    U1.ID AS ZDRID, U1.USERNAME AS ZDRUSERNAME, U1.REALNAME AS ZDRREALNAME
	    FROM B_G2_012 B1
	    	LEFT JOIN B_G2_011 W ON B1.JX = W.JX AND B1.WXFABH = W.WXFABH AND B1.DPRTCODE = W.DPRTCODE 
	    	AND CASE WHEN B1.B_BBID IS NULL THEN W.B_BBID ELSE B1.B_BBID END IS NULL
	    	AND CASE WHEN B1.B_BBID IS NOT NULL THEN W.BB ELSE B1.BB END = B1.BB
	    	LEFT JOIN B_G_003 W1B2 ON W.ID = W1B2.ZLID
		    LEFT JOIN B_G2_001 W1B3 ON W1B2.PGDID = W1B3.ID
		    LEFT JOIN D_005 D1 ON B1.ZJH = D1.ZJH AND B1.DPRTCODE = D1.DPRTCODE AND D1.ZT = 1
		    LEFT JOIN B_G2_01204 B2 ON B1.ID = B2.MAINID
		    LEFT JOIN B_G2_01101 B3 ON B1.WXXMDLID = B3.ID
		    LEFT JOIN B_G2_01201 B4 ON B1.ID = B4.MAINID AND B4.ZT = 1
		    LEFT JOIN B_G2_01203 B5 ON B1.ID = B5.MAINID
		    LEFT JOIN B_G2_995 B6 ON B1.ID = B6.YWID
		    LEFT JOIN B_G2_01204 B7 ON B4.JKDXID = B7.ID
		    LEFT JOIN D_021 B6D1 ON B6.GBID= B6D1.ID
		    LEFT JOIN D_006 B4D1 ON B4.JKFLBH = B4D1.JKFLBH
		    LEFT JOIN D_00601 B4D2 ON B4.JKLBH = B4D2.JKLBH
		    LEFT JOIN B_G2_010 E ON B1.EOBH = E.EOBH AND B1.JX = E.JX AND B1.DPRTCODE = E.DPRTCODE
	   			AND E.ZT = 7 AND E.ZXBS = 2 AND E.ZXFS = 2
		    LEFT JOIN T_USER U1 ON B1.ZDRID = U1.ID
   		WHERE B1.ID = #{id,jdbcType=VARCHAR} 
   		  ORDER BY B5.FJZCH, B4.JKLBH, B6.XC, B6D1.GBBH, B7.BJH, B7.CJ
    </select>
    
    <!-- 查询维修项目版本历史版本 -->
	<select id="queryVersionList" resultMap="MaintenanceProjectJoinMap" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
	    SELECT 
	    <include refid="Maintenance_Project_Column_List" />,
	    W.ID AS WID, W.DPRTCODE AS WDPRTCODE, W.JX AS WJX, W.WXFABH AS WWXFABH, W.BB AS WBB, 
		W.ZWMS AS WZWMS, W.ZXBS AS WZXBS, W.ZT AS WZT, W.GBYJ AS WGBYJ, W.SJ_SXRQ AS WSJSXRQ
	    FROM B_G2_012 B
	    LEFT JOIN B_G2_011 W ON B.JX = W.JX AND B.WXFABH = W.WXFABH AND B.DPRTCODE = W.DPRTCODE AND B.BB = W.BB
	    INNER JOIN B_G2_012 SELF 
	    	ON SELF.JX = B.JX 
	       AND SELF.WXFABH = B.WXFABH 
	       AND SELF.DPRTCODE = B.DPRTCODE
	       AND SELF.RWH = B.RWH
	    WHERE SELF.ID = #{id,jdbcType=VARCHAR}
	    ORDER BY B.BB DESC
    </select>
    
    <!-- 查询监控项目适用性 -->
  <select id="queryMonitorItemModel" resultMap="MaintenanceProjectJoinMap" parameterType="java.lang.String">
    SELECT 
	    B1.ID, B1.DPRTCODE, B1.JX, B1.WXFABH, B1.WXXMDLID, B1.WXXMLX, B1.ZJH, B1.RWH, B1.BB, 
	    B1.CKH, B1.RWMS, B1.SYX, B1.CKWJ, B1.GZLX, B1.XMLX, B1.IS_BJ, B1.ALI, 
	    B1.JHGS_RS, B1.JHGS_XSS, B1.GKBH, B1.JSGS, B1.IS_HDWZ, B1.BZ, B1.ZT, B1.F_BBID, 
	    B1.B_BBID, B1.ZDBMID, B1.ZDRID, B1.ZDSJ,
	    B4.ID AS B4ID, B4.JKLBH AS B4JKLBH, B4.JKFLBH AS B4JKFLBH, B4.SCZ AS B4SCZ, B4.DW_SCZ AS B4DW_SCZ,
	    B4.ZQZ AS B4ZQZ, B4.DW_ZQZ AS B4DW_ZQZ, B4.YDZ_Q AS B4YDZ_Q, B4.YDZ_QDW AS B4YDZ_QDW, B4.YDZ_H AS B4YDZ_H,
	    B4.YDZ_HDW AS B4YDZ_HDW, B7.BJH AS B4BJH,
	    B4D1.JKFLBH AS B4D1JKFLBH, B4D1.MS AS B4D1MS, B4D1.PXH AS B4D1PXH,
	    B4D2.JKLBH AS B4D2JKLBH, B4D2.MS AS B4D2MS, B4D2.PXH AS B4D2PXH, B4D2.JKFLBH AS B4D2JKFLBH,
	    B5.ID AS B5ID, B5.FJZCH AS B5FJZCH
    FROM B_G2_012 B1
      LEFT JOIN B_G2_01201 B4 ON B1.ID = B4.MAINID AND B4.ZT = 1
      LEFT JOIN B_G2_01204 B7 ON B4.JKDXID = B7.ID
      LEFT JOIN D_006 B4D1 ON B4.JKFLBH = B4D1.JKFLBH
      LEFT JOIN D_00601 B4D2 ON B4.JKLBH = B4D2.JKLBH
      LEFT JOIN B_G2_01203 B5 ON B5.MAINID = B1.ID
      where B1.ID = #{id,jdbcType=VARCHAR}
      ORDER BY B1.BB DESC, B7.BJH, B4.JKLBH asc, B5.FJZCH
  </select>
  
  <!-- 根据条件查询监控项目适用性 -->
  <select id="queryMonitorItemModelByWxxm" resultMap="MaintenanceProjectJoinMap" parameterType="com.eray.thjw.project2.po.MaintenanceProject">
    SELECT 
	    B1.ID, B1.DPRTCODE, B1.JX, B1.WXFABH, B1.WXXMDLID, B1.WXXMLX, B1.ZJH, B1.RWH, B1.BB, 
	    B1.CKH, B1.RWMS, B1.SYX, B1.CKWJ, B1.GZLX, B1.XMLX, B1.IS_BJ, B1.ALI, 
	    B1.JHGS_RS, B1.JHGS_XSS, B1.GKBH, B1.JSGS, B1.IS_HDWZ, B1.BZ, B1.ZT, B1.F_BBID, 
	    B1.B_BBID, B1.ZDBMID, B1.ZDRID, B1.ZDSJ,
	    B4.ID AS B4ID, B4.JKLBH AS B4JKLBH, B4.JKFLBH AS B4JKFLBH, B4.SCZ AS B4SCZ, B4.DW_SCZ AS B4DW_SCZ,
	    B4.ZQZ AS B4ZQZ, B4.DW_ZQZ AS B4DW_ZQZ, B4.YDZ_Q AS B4YDZ_Q, B4.YDZ_QDW AS B4YDZ_QDW, B4.YDZ_H AS B4YDZ_H,
	    B4.YDZ_HDW AS B4YDZ_HDW, B7.BJH AS B4BJH,
	    B4D1.JKFLBH AS B4D1JKFLBH, B4D1.MS AS B4D1MS, B4D1.PXH AS B4D1PXH,
	    B4D2.JKLBH AS B4D2JKLBH, B4D2.MS AS B4D2MS, B4D2.PXH AS B4D2PXH, B4D2.JKFLBH AS B4D2JKFLBH,
	    B5.ID AS B5ID, B5.FJZCH AS B5FJZCH,
	    D005.ZJH AS D1ZJH,
   		D005.ZWMS AS D1ZWMS,
   		D005.YWMS AS D1YWMS
    FROM B_G2_012 B1
    	JOIN B_G2_01102 t2
  		ON t2.wxxmid = B1.ID
  		JOIN B_G2_011 t1 
  		ON t1.id = t2.mainid and t1.jx = #{jx,jdbcType=VARCHAR} and t1.zxbs = 2
      	LEFT JOIN B_G2_01201 B4 ON B1.ID = B4.MAINID AND B4.ZT = 1
      	LEFT JOIN B_G2_01204 B7 ON B4.JKDXID = B7.ID
      	LEFT JOIN D_006 B4D1 ON B4.JKFLBH = B4D1.JKFLBH
      	LEFT JOIN D_00601 B4D2 ON B4.JKLBH = B4D2.JKLBH
      	LEFT JOIN B_G2_01203 B5 ON B5.MAINID = B1.ID
      	LEFT JOIN D_005 D005 on B1.DPRTCODE = D005.DPRTCODE and B1.ZJH = D005.ZJH
      	where B1.wxxmlx in (1, 2, 3) and B1.yxbs = 1 and B1.DPRTCODE = #{dprtcode,jdbcType=VARCHAR} and B1.jx = #{jx,jdbcType=VARCHAR}
      		 and B1.RWH = #{rwh,jdbcType=VARCHAR}
      		 and not exists (select 1
	          	from b_g2_013 t
	         	where t.jx = #{jx,jdbcType=VARCHAR}
	            and t.WXXMBH = B1.RWH
	            and t.DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
	            and t.zt != 8 and t.zxbs in (1,2) 
	           	<if test="gkbh != null and gkbh != ''" >
	        		and t.gkh != #{gkbh,jdbcType=VARCHAR}
	      		</if>
			)
      ORDER BY B1.BB DESC, B7.BJH, B4.JKLBH asc, B5.FJZCH
      
  </select>
  
  <!-- 清空后版本id -->
  <update id="updateBbbid" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    update B_G2_012
    set 
      B_BBID = #{bBbid,jdbcType=VARCHAR},
      ZDBMID = #{zdbmid,jdbcType=VARCHAR},
      ZDRID = #{zdrid,jdbcType=VARCHAR},
      ZDSJ = #{zdsj,jdbcType=TIMESTAMP}
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  
  <!-- 查询维修项目有没有被其他维修项目关联 -->
  <select id="queryOtherRelation" resultMap="BaseResultMap" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    SELECT B2.WXXMBH AS RWH FROM B_G2_012 B1
		INNER JOIN B_G2_01202 B2 ON B1.ID = B2.MAINID AND B2.ZT = 1
		INNER JOIN B_G2_01202 B3 ON B2.JX = B3.JX AND B2.WXXMBH = B3.WXXMBH AND B2.ID != B3.ID AND B3.ZT = 1
		INNER JOIN B_G2_012 B4 ON B3.MAINID = B4.ID AND B1.DPRTCODE = B4.DPRTCODE AND B1.RWH != B4.RWH 
			AND B4.YXBS = 1 AND B4.B_BBID IS NULL
			AND B4.WXXMLX != (CASE WHEN B1.WXXMLX != 4 THEN 4 ELSE -1 END)
      		AND B4.WXXMLX >= (CASE WHEN B1.WXXMLX = 4 THEN 4 ELSE -1 END)
	  WHERE B1.ID = #{id,jdbcType=VARCHAR}
  </select>
  
  	<!-- 查询适用维修项目 -->
  	<select id="queryApplyList" resultMap="MaintenanceProjectJoinMap" 
		parameterType="com.eray.thjw.produce.po.InstallationListEditable">
		SELECT B1.DPRTCODE,
		       B1.JX,
		       B3.WXXMLX,
		       B3.RWH,
		       B3.ID,
		       B3.RWMS,
		       B3.BB,
		       B5.ID AS B4ID,
		       B5.JKLBH AS B4JKLBH,
		       B5.JKFLBH AS B4JKFLBH,
		       B5.SCZ AS B4SCZ,
		       B5.DW_SCZ AS B4DW_SCZ,
		       B5.ZQZ AS B4ZQZ,
		       B5.DW_ZQZ AS B4DW_ZQZ,
		       B5.YDZ_Q AS B4YDZ_Q,
		       B5.YDZ_QDW AS B4YDZ_QDW,
		       B5.YDZ_H AS B4YDZ_H,
		       B5.YDZ_HDW AS B4YDZ_HDW
		  FROM B_G2_011 B1
		  JOIN B_G2_01102 B2
		    ON B1.ID = B2.MAINID
		   AND B1.DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
		   AND B1.JX = #{jx,jdbcType=VARCHAR}
		   AND B1.ZXBS = 2
		  JOIN B_G2_012 B3
		    ON B2.WXXMID = B3.ID
		   AND B3.YXBS = 1
		   AND B3.WXXMLX IN (2, 3)
		   JOIN B_G2_01204 B4 ON B3.ID = B4.MAINID AND B4.BJH = #{bjh,jdbcType=VARCHAR}
		  LEFT JOIN B_G2_01201 B5
		    ON B3.ID = B5.MAINID
		   AND B5.ZT = 1
		   AND B5.JKDXID = B4.ID
		 WHERE (EXISTS (SELECT 1
		                  FROM B_G2_01203 T
		                 WHERE T.MAINID = B3.ID
		                   AND T.FJZCH = #{fjzch,jdbcType=VARCHAR}) OR B3.SYX = '00000')
		   ORDER BY B3.RWH, B5.JKLBH
    </select>
    
    <!-- 查询适用维修项目(航材/工具检验) -->
  	<select id="queryApplyListByBjh" resultMap="MaintenanceProjectJoinMap" parameterType="java.lang.String">
		SELECT B1.DPRTCODE,
		       B1.JX,
		       B3.WXXMLX,
		       B3.RWH,
		       B3.ID,
		       B3.RWMS,
		       B3.BB,
		       B5.ID AS B4ID,
		       B5.JKLBH AS B4JKLBH,
		       B5.JKFLBH AS B4JKFLBH,
		       B5.SCZ AS B4SCZ,
		       B5.DW_SCZ AS B4DW_SCZ,
		       B5.ZQZ AS B4ZQZ,
		       B5.DW_ZQZ AS B4DW_ZQZ,
		       B5.YDZ_Q AS B4YDZ_Q,
		       B5.YDZ_QDW AS B4YDZ_QDW,
		       B5.YDZ_H AS B4YDZ_H,
		       B5.YDZ_HDW AS B4YDZ_HDW
		  FROM B_G2_011 B1
		  JOIN B_G2_01102 B2
		    ON B1.ID = B2.MAINID
		   AND B1.DPRTCODE = #{dprtcode,jdbcType=VARCHAR}
		   AND B1.ZXBS = 2
		  JOIN B_G2_012 B3
		    ON B2.WXXMID = B3.ID
		   AND B3.YXBS = 1
		   AND B3.WXXMLX IN (2, 3)
		   JOIN B_G2_01204 B4 ON B3.ID = B4.MAINID AND B4.BJH = #{bjh,jdbcType=VARCHAR}
		  LEFT JOIN B_G2_01201 B5
		    ON B3.ID = B5.MAINID
		   AND B5.ZT = 1
		   AND B5.JKDXID = B4.ID
		   ORDER BY B3.RWH, B5.JKLBH
    </select>
    
    <!-- 根据维修方案查询生效的维修项目 -->
  <select id="selectEffectMPListWithMonitorBySId" resultMap="MaintenanceProjectJoinMap" 
  		parameterType="string" >
    SELECT 
	    B1.ID, B1.DPRTCODE, B1.JX, B1.WXFABH, B1.WXXMDLID, B1.WXXMLX, B1.ZJH, B1.RWH, B1.BB, 
	    B1.CKH, B1.RWMS, B1.SYX, B1.CKWJ, B1.GZLX, B1.XMLX, B1.IS_BJ, B1.ALI, 
	    B1.JHGS_RS, B1.JHGS_XSS, B1.GKBH, B1.JSGS, B1.IS_HDWZ, B1.BZ, B1.ZT, B1.F_BBID, 
	    B1.B_BBID, B1.ZDBMID, B1.ZDRID, B1.ZDSJ, B1.YXBS, B1.EOBH,
	    B4.ID AS B4ID, B4.JKLBH AS B4JKLBH, B4.JKFLBH AS B4JKFLBH, B4.SCZ AS B4SCZ, B4.DW_SCZ AS B4DW_SCZ,
	    B4.ZQZ AS B4ZQZ, B4.DW_ZQZ AS B4DW_ZQZ, B4.YDZ_Q AS B4YDZ_Q, B4.YDZ_QDW AS B4YDZ_QDW, B4.YDZ_H AS B4YDZ_H,
	    B4.YDZ_HDW AS B4YDZ_HDW, B2.BJH AS B4BJH
    FROM B_G2_01102 F2
    INNER JOIN B_G2_012 B1 ON B1.YXBS = 1 and F2.WXXMID = B1.ID AND F2.MAINID = #{id,jdbcType=VARCHAR} 
    LEFT JOIN B_G2_01201 B4 ON B1.ID = B4.MAINID AND B4.ZT = 1
    LEFT JOIN B_G2_01204 B2 ON B4.JKDXID = B2.ID
    where 1 = 1
  </select>
  
  	<!-- 更新后版本id -->
  	<update id="udpateBBbid" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
		UPDATE B_G2_012 
			SET 
		      B_BBID = #{bBbid,jdbcType=TIMESTAMP}
		    WHERE 
		      ID = #{id,jdbcType=VARCHAR}
  	</update>
  	
  <!-- 维修项目更新 -->
  <update id="updateByMaintenanceProject" parameterType="com.eray.thjw.project2.po.MaintenanceProject" >
    update B_G2_012
    <set >
      <if test="jx != null" >
        JX = #{jx,jdbcType=VARCHAR},
      </if>
      <if test="wxfabh != null" >
        WXFABH = #{wxfabh,jdbcType=VARCHAR},
      </if>
      <if test="wxxmdlid != null" >
        WXXMDLID = #{wxxmdlid,jdbcType=VARCHAR},
      </if>
      <if test="wxxmlx != null" >
        WXXMLX = #{wxxmlx,jdbcType=DECIMAL},
      </if>
      <if test="zjh != null" >
        ZJH = #{zjh,jdbcType=VARCHAR},
      </if>
      <if test="rwh != null" >
        RWH = #{rwh,jdbcType=VARCHAR},
      </if>
      <if test="bb != null" >
        BB = #{bb,jdbcType=DECIMAL},
      </if>
      <if test="ckh != null" >
        CKH = #{ckh,jdbcType=VARCHAR},
      </if>
      <if test="rwms != null" >
        RWMS = #{rwms,jdbcType=VARCHAR},
      </if>
      <if test="syx != null" >
        SYX = #{syx,jdbcType=VARCHAR},
      </if>
      <if test="ckwj != null" >
        CKWJ = #{ckwj,jdbcType=VARCHAR},
      </if>
      <if test="gzlx != null" >
        GZLX = #{gzlx,jdbcType=VARCHAR},
      </if>
      <if test="xmlx != null" >
        XMLX = #{xmlx,jdbcType=VARCHAR},
      </if>
      <if test="isBj != null" >
        IS_BJ = #{isBj,jdbcType=DECIMAL},
      </if>
      <if test="ali != null" >
        ALI = #{ali,jdbcType=DECIMAL},
      </if>
      JHGS_RS = #{jhgsRs,jdbcType=DECIMAL},
      JHGS_XSS = #{jhgsXss,jdbcType=DECIMAL},
      <if test="gkbh != null" >
        GKBH = #{gkbh,jdbcType=VARCHAR},
      </if>
      <if test="eobh != null" >
        EOBH = #{eobh,jdbcType=VARCHAR},
      </if>
      <if test="jsgs != null" >
        JSGS = #{jsgs,jdbcType=DECIMAL},
      </if>
      <if test="isHdwz != null" >
        IS_HDWZ = #{isHdwz,jdbcType=DECIMAL},
      </if>
      <if test="bz != null" >
        BZ = #{bz,jdbcType=VARCHAR},
      </if>
      <if test="zt != null" >
        ZT = #{zt,jdbcType=DECIMAL},
      </if>
      <if test="yxbs != null" >
        YXBS = #{yxbs,jdbcType=DECIMAL},
      </if>
      <if test="fBbid != null" >
        F_BBID = #{fBbid,jdbcType=VARCHAR},
      </if>
      <if test="bBbid != null" >
        B_BBID = #{bBbid,jdbcType=VARCHAR},
      </if>
      <if test="zdbmid != null" >
        ZDBMID = #{zdbmid,jdbcType=VARCHAR},
      </if>
      <if test="zdrid != null" >
        ZDRID = #{zdrid,jdbcType=VARCHAR},
      </if>
      <if test="zdsj != null" >
        ZDSJ = #{zdsj,jdbcType=TIMESTAMP},
      </if>
      <if test="cmph != null" >
        CMPH = #{cmph,jdbcType=VARCHAR},
      </if>
      <if test="jgms != null" >
        JGMS = #{jgms,jdbcType=VARCHAR},
      </if>
      WZ = #{wz,jdbcType=DECIMAL}
    </set>
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  
  <!-- 根据多个维修项目id查询监控项目，以mainid,JKLBH进行排序  -->
  <select id="selectMonitorByMainIds" parameterType="java.util.List" resultType="com.eray.thjw.project2.po.ProjectMonitor">
	  	SELECT B_G2_01201.ID,
	       B_G2_01201.MAINID,
	       B_G2_01201.JKLBH,
	       B_G2_01201.JKFLBH,
	       B_G2_01201.SCZ,
	       B_G2_01201.DW_SCZ,
	       B_G2_01201.ZQZ,
	       B_G2_01201.DW_ZQZ,
	       B_G2_01201.YDZ_Q,
	       B_G2_01201.YDZ_QDW,
	       B_G2_01201.YDZ_H,
	       B_G2_01201.YDZ_HDW,
	       B_G2_01201.JKDXID,
	       b_g2_01204.BJH
	  FROM B_G2_01201 
	  left join b_g2_01204 on B_G2_01201.jkdxid = b_g2_01204.id 
	 WHERE B_G2_01201.ZT = 1
	   AND B_G2_01201.MAINID IN 
	   <foreach collection="list" item="item" open="(" close=")" separator=",">
	   	#{item, jdbcType=VARCHAR}
	   </foreach>
	   ORDER BY B_G2_01201.MAINID, B_G2_01201.JKLBH
  </select>
   <!-- 根据多个维修项目id及部件号查询监控项目，以mainid,JKLBH进行排序  -->
  <select id="selectMonitorByMainIdsAndBjh" resultType="com.eray.thjw.project2.po.ProjectMonitor">
	  	SELECT B_G2_01201.ID,
	       B_G2_01201.MAINID,
	       B_G2_01201.JKLBH,
	       B_G2_01201.JKFLBH,
	       B_G2_01201.SCZ,
	       B_G2_01201.DW_SCZ,
	       B_G2_01201.ZQZ,
	       B_G2_01201.DW_ZQZ,
	       B_G2_01201.YDZ_Q,
	       B_G2_01201.YDZ_QDW,
	       B_G2_01201.YDZ_H,
	       B_G2_01201.YDZ_HDW,
	       B_G2_01201.JKDXID
	  FROM B_G2_01201
	  JOIN B_G2_01204 ON B_G2_01201.MAINID = B_G2_01204.MAINID 
	  			AND B_G2_01201.JKDXID = B_G2_01204.ID
	  			AND B_G2_01204.BJH = #{bjh, jdbcType=VARCHAR}
	 WHERE B_G2_01201.ZT = 1
	   AND B_G2_01201.MAINID IN 
	   <foreach collection="list" item="item" open="(" close=")" separator=",">
	   	#{item, jdbcType=VARCHAR}
	   </foreach>
	   ORDER BY B_G2_01201.MAINID, B_G2_01201.JKLBH
  </select>
  
     <!-- 导入专用: 根据机构代码、维修方案编号、任务号、版本号，导入专用   -->
  	<select id="getWxxmByParam" parameterType="java.lang.String" resultType="com.eray.thjw.project2.po.MaintenanceProject">
	    select 
	    	<include refid="Base_Column_List" />
	    from B_G2_012
	    where DPRTCODE = #{dprtcode,jdbcType=VARCHAR} and WXFABH = #{wxfabh,jdbcType=VARCHAR} and RWH = #{rwh,jdbcType=VARCHAR} and BB = #{bb,jdbcType=VARCHAR}
	</select>
	
	<!-- 导入专用: 机构代码、维修方案编号、任务号、有效标识=1、后版本id is null -->
  	<select id="getPreWxxmByParam" parameterType="java.lang.String" resultType="com.eray.thjw.project2.po.MaintenanceProject">
	    select 
	    	<include refid="Base_Column_List" />
	    from B_G2_012
	    where DPRTCODE = #{dprtcode,jdbcType=VARCHAR} and WXFABH = #{wxfabh,jdbcType=VARCHAR} and RWH = #{rwh,jdbcType=VARCHAR} and 
	          YXBS = 1 and B_BBID is null
	</select>
	
	  <!-- 批量新增:导入专用 -->
	  <insert id="insert4Batch" parameterType="java.util.List" >
		    INSERT INTO B_G2_012 (ID, DPRTCODE, JX, 
							      WXFABH, WXXMDLID, WXXMLX, 
							      ZJH, RWH, BB, CKH, 
							      RWMS, SYX, CKWJ, GZLX, 
							      XMLX, IS_BJ, ALI, 
							      JHGS_RS, JHGS_XSS, GKBH, EOBH ,
							      JSGS, IS_HDWZ, BZ, ZT, 
							      YXBS, F_BBID, B_BBID, 
							      ZDBMID, ZDRID, ZDSJ,
							      CMPH, WZ)
		      <foreach collection="list" item="item" index="index" open="(" close=")" separator="union all"> 
			    select 
			    	  #{item.id,jdbcType=VARCHAR}, #{item.dprtcode,jdbcType=VARCHAR}, #{item.jx,jdbcType=VARCHAR}, 
				      #{item.wxfabh,jdbcType=VARCHAR}, #{item.wxxmdlid,jdbcType=VARCHAR}, #{item.wxxmlx,jdbcType=DECIMAL}, 
				      #{item.zjh,jdbcType=VARCHAR}, #{item.rwh,jdbcType=VARCHAR}, #{item.bb,jdbcType=DECIMAL}, #{item.ckh,jdbcType=VARCHAR}, 
				      #{item.rwms,jdbcType=VARCHAR}, #{item.syx,jdbcType=VARCHAR}, #{item.ckwj,jdbcType=VARCHAR}, #{item.gzlx,jdbcType=VARCHAR}, 
				      #{item.xmlx,jdbcType=VARCHAR}, #{item.isBj,jdbcType=DECIMAL}, #{item.ali,jdbcType=DECIMAL}, 
				      #{item.jhgsRs,jdbcType=DECIMAL}, #{item.jhgsXss,jdbcType=DECIMAL}, #{item.gkbh,jdbcType=VARCHAR}, #{item.eobh,jdbcType=VARCHAR},
				      #{item.jsgs,jdbcType=DECIMAL}, #{item.isHdwz,jdbcType=DECIMAL}, #{item.bz,jdbcType=VARCHAR}, #{item.zt,jdbcType=DECIMAL}, 
				      #{item.yxbs,jdbcType=DECIMAL}, #{item.fBbid,jdbcType=VARCHAR}, #{item.bBbid,jdbcType=VARCHAR}, 
				      #{item.zdbmid,jdbcType=VARCHAR}, #{item.zdrid,jdbcType=VARCHAR}, #{item.zdsj,jdbcType=TIMESTAMP},
				      #{item.cmph,jdbcType=VARCHAR}, #{item.wz,jdbcType=DECIMAL}
			  	from dual
		    </foreach>
	  </insert>
	  
	  <!-- 批量修改: 导入专用 -->
	  <update id="update4Batch" parameterType="java.util.List">
	  	<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";">
	       update B_G2_012 
	        <set >
      			<if test="item.wxxmlx != null">
      				WXXMLX = #{item.wxxmlx,jdbcType=DECIMAL},
      			</if>
			      WXXMDLID = #{item.wxxmdlid,jdbcType=VARCHAR},
			      ZJH = #{item.zjh,jdbcType=VARCHAR},
			      CKH = #{item.ckh,jdbcType=VARCHAR},
			      CMPH = #{item.cmph,jdbcType=TIMESTAMP},
			      RWMS = #{item.rwms,jdbcType=VARCHAR},
			      SYX = #{item.syx,jdbcType=VARCHAR},
			      CKWJ = #{item.ckwj,jdbcType=VARCHAR},
			      GZLX = #{item.gzlx,jdbcType=VARCHAR},
			      XMLX = #{item.xmlx,jdbcType=VARCHAR},
			      IS_BJ = #{item.isBj,jdbcType=DECIMAL},
			      ALI = #{item.ali,jdbcType=DECIMAL},
			      JHGS_RS = #{item.jhgsRs,jdbcType=DECIMAL},
			      JHGS_XSS = #{item.jhgsXss,jdbcType=DECIMAL},
			      JSGS = #{item.jsgs,jdbcType=DECIMAL},
			      IS_HDWZ = #{item.isHdwz,jdbcType=DECIMAL},
			      BZ = #{item.bz,jdbcType=VARCHAR},
			      ZT = 1,
			      YXBS = 1,
			      ZDBMID = #{item.zdbmid,jdbcType=VARCHAR},
			      ZDRID = #{item.zdrid,jdbcType=VARCHAR},
			      ZDSJ = #{item.zdsj,jdbcType=TIMESTAMP}
      		</set>
	       where ID = #{item.id,jdbcType=VARCHAR}
	    </foreach>
	  </update>
	  
	   <!-- 批量修改前版本的后版本ID: 导入专用 -->
	  <update id="updatePreBb4Batch" parameterType="java.util.List">
	  	<foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";">
	       update B_G2_012 
	       set
			  B_BBID = #{item.bBbid,jdbcType=VARCHAR}
	       where ID = #{item.id,jdbcType=VARCHAR}
	    </foreach>
	  </update>
	  
	<!-- 获取最新的维修项目 -->
  	<select id="getLatestWxxm" parameterType="com.eray.thjw.project2.po.MaintenanceProject" 
  			resultType="com.eray.thjw.project2.po.MaintenanceProject">
	    select 
	    	<include refid="Base_Column_List" />
	    from B_G2_012
	    where DPRTCODE = #{dprtcode,jdbcType=VARCHAR} and WXFABH = #{wxfabh,jdbcType=VARCHAR} and RWH = #{rwh,jdbcType=VARCHAR} and 
	          B_BBID is null
	</select>
	
	<!-- 更新维修项目版本至最新 -->
  	<update id="updateVersion" parameterType="com.eray.thjw.project2.po.MaintenanceScheme">
	    update B_G2_012
	    set bb = #{bb,jdbcType=DECIMAL}
	    where DPRTCODE = #{dprtcode,jdbcType=VARCHAR} and WXFABH = #{wxfabh,jdbcType=VARCHAR} and JX = #{jx,jdbcType=VARCHAR} and
	          bb = #{paramsMap.oldBb,jdbcType=DECIMAL} and B_BBID is null
	</update>
</mapper>